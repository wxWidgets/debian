<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<!--BEGIN PROJECT_NAME--><title>wxWidgets: wxWidgets: Persistent Objects Overview</title><!--END PROJECT_NAME-->
<!--BEGIN !PROJECT_NAME--><title>wxWidgets: Persistent Objects Overview</title><!--END !PROJECT_NAME-->
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="custom_stylesheet.css" rel="stylesheet" type="text/css" />
$treeview
$search
$mathjax
</head>
<body>
<div id="top"><!-- do not remove this div! -->

<!--BEGIN TITLEAREA-->
<div id="titlearea">
<table cellspacing="0" cellpadding="0" style="width: 100%;">
 <tbody>
 <tr>
  <!--BEGIN PROJECT_LOGO-->
  <td id="projectlogo"><a href="http://www.wxwidgets.org/" target="_new"><img alt="Logo" src="$projectlogo"/></a></td>
  <!--END PROJECT_LOGO-->
  <td style="padding: 0.5em; text-align: right;">
   <!--BEGIN PROJECT_NUMBER--><span id="projectnumber">Version: 2.9.3</span><!--END PROJECT_NUMBER-->
  </td>
  <!--BEGIN DISABLE_INDEX-->
   <!--BEGIN SEARCHENGINE-->
   <td>$searchbox</td>
   <!--END SEARCHENGINE-->
  <!--END DISABLE_INDEX-->
 </tr>
 </tbody>
</table>
</div>
<!--END TITLEAREA-->
<!-- Generated by Doxygen 1.7.1 -->
<script type="text/javascript">
function hasClass(ele,cls) {
  return ele.className.match(new RegExp('(\\s|^)'+cls+'(\\s|$)'));
}

function addClass(ele,cls) {
  if (!this.hasClass(ele,cls)) ele.className += " "+cls;
}

function removeClass(ele,cls) {
  if (hasClass(ele,cls)) {
    var reg = new RegExp('(\\s|^)'+cls+'(\\s|$)');
    ele.className=ele.className.replace(reg,' ');
  }
}

function toggleVisibility(linkObj) {
 var base = linkObj.getAttribute('id');
 var summary = document.getElementById(base + '-summary');
 var content = document.getElementById(base + '-content');
 var trigger = document.getElementById(base + '-trigger');
 if ( hasClass(linkObj,'closed') ) {
   summary.style.display = 'none';
   content.style.display = 'block';
   trigger.src = 'open.png';
   removeClass(linkObj,'closed');
   addClass(linkObj,'opened');
 } else if ( hasClass(linkObj,'opened') ) {
   summary.style.display = 'block';
   content.style.display = 'none';
   trigger.src = 'closed.png';
   removeClass(linkObj,'opened');
   addClass(linkObj,'closed');
 }
 return false;
}
</script>
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Categories</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="navpath">
    <ul>
      <li><a class="el" href="index.html">Documentation</a>      </li>
      <li><a class="el" href="page_topics.html">Topic Overviews</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<h1>Persistent Objects Overview </h1>  </div>
</div>
<div class="contents">
<p>Persistent objects are simply the objects which automatically save their state when they are destroyed and restore it when they are recreated, even during another program invocation.</p>
<p>Most often, persistent objects are, in fact, persistent windows as it is especially convenient to automatically restore the UI state when the program is restarted but an object of any class can be made persistent. Moreover, persistence is implemented in a non-intrusive way so that the original object class doesn't need to be modified at all in order to add support for saving and restoring its properties.</p>
<p>The persistence framework involves</p>
<ul>
<li><a class="el" href="classwx_persistence_manager.html" title="Provides support for automatically saving and restoring object properties to persistent storage...">wxPersistenceManager</a> which all persistent objects register themselves with. This class handles actual saving and restoring of persistent data as well as various global aspects of persistence, e.g. it can be used to disable restoring the saved data.</li>
<li><a class="el" href="classwx_persistent_object.html" title="Base class for persistent object adapters.">wxPersistentObject</a> is the base class for all persistent objects or, rather, adaptors for the persistent objects as this class main purpose is to provide the bridge between the original class -- which has no special persistence support -- and <a class="el" href="classwx_persistence_manager.html" title="Provides support for automatically saving and restoring object properties to persistent storage...">wxPersistenceManager</a>,</li>
<li>wxPersistentWindow&lt;&gt; which derives from <a class="el" href="classwx_persistent_object.html" title="Base class for persistent object adapters.">wxPersistentObject</a> and implements some of its methods using wxWindow-specific functionality. Notably, <a class="el" href="classwx_persistence_manager.html" title="Provides support for automatically saving and restoring object properties to persistent storage...">wxPersistenceManager</a> handles the destruction of persistent windows automatically implicitly while it has to be done explicitly for the arbitrary persistent objects.</li>
<li><a class="el" href="interface_2wx_2persist_2bookctrl_8h.html#a8b21681a5cb6009c8acb05f474ca1899" title="Overload allowing persistence adapter creation for wxBookCtrlBase-derived objects.">wxCreatePersistentObject()</a> function which is used to create the appropriate persistence adapter for the object.</li>
</ul>
<h2><a class="anchor" id="persistence_using"></a>
Using Persistent Windows</h2>
<p>wxWidgets has built-in support for a (constantly growing) number of controls. Currently the following classes are supported:</p>
<ul>
<li><a class="el" href="classwx_top_level_window.html" title="wxTopLevelWindow is a common base class for wxDialog and wxFrame.">wxTopLevelWindow</a> (and hence <a class="el" href="classwx_frame.html" title="A frame is a window whose size and position can (usually) be changed by the user.">wxFrame</a> and <a class="el" href="classwx_dialog.html" title="A dialog box is a window with a title bar and sometimes a system menu, which can be moved around the ...">wxDialog</a>)</li>
<li><a class="el" href="classwx_book_ctrl_base.html" title="A book control is a convenient way of displaying multiple pages of information, displayed one page at...">wxBookCtrlBase</a>, i.e. <a class="el" href="classwx_notebook.html" title="This class represents a notebook control, which manages multiple windows with associated tabs...">wxNotebook</a>, <a class="el" href="classwx_listbook.html" title="wxListbook is a class similar to wxNotebook but which uses a wxListCtrl to show the labels instead of...">wxListbook</a>, <a class="el" href="classwx_toolbook.html" title="wxToolbook is a class similar to wxNotebook but which uses a wxToolBar to show the labels instead of ...">wxToolbook</a> and <a class="el" href="classwx_choicebook.html" title="wxChoicebook is a class similar to wxNotebook, but uses a wxChoice control to show the labels instead...">wxChoicebook</a></li>
<li><a class="el" href="classwx_treebook.html" title="This class is an extension of the wxNotebook class that allows a tree structured set of pages to be s...">wxTreebook</a></li>
</ul>
<p>To automatically save and restore the properties of the windows of classes listed above you need to</p>
<ol type="1">
<li>Set a unique name for the window using <a class="el" href="classwx_window.html#af80875cda5e1af98dcd7c8e712e3c800" title="Sets the window&#39;s name.">wxWindow::SetName()</a>: this step is important as the name is used in the configuration file and so must be unique among all windows of the same class.</li>
<li>Call <a class="el" href="classwx_persistence_manager.html#a94e205e486abe0001ebd15af9e81dc63" title="Register an object with the manager automatically creating a persistence adapter for it...">wxPersistenceManager::Register()</a> at any moment after creating the window and then <a class="el" href="classwx_persistence_manager.html#a932d8f5cf981aed723f79d1923f67aed" title="Restore the object properties previously saved by Save().">wxPersistenceManager::Restore()</a> when the settings may be restored (which can't be always done immediately, e.g. often the window needs to be populated first). If settings can be restored immediately after the window creation, as is often the case for <a class="el" href="classwx_top_level_window.html" title="wxTopLevelWindow is a common base class for wxDialog and wxFrame.">wxTopLevelWindow</a>, for example, then <a class="el" href="classwx_persistence_manager.html#aa6a195c6e56cb6e325d2f07afb0e0a44" title="Combines both Register() and Restore() calls.">wxPersistenceManager::RegisterAndRestore()</a> can be used to do both at once.</li>
<li>If you do not want the settings for the window to be saved (for example the changes to the dialog size are usually not saved if the dialog was cancelled), you need to call <a class="el" href="classwx_persistence_manager.html#a453383431eb8f8127f0ac0d8a2cee1c5" title="Unregister the object and delete the associated wxPersistentObject.">wxPersistenceManager::Unregister()</a> manually. Otherwise the settings will be automatically saved when the control itself is destroyed.</li>
</ol>
<p>Example of using a notebook control which automatically remembers the last open page: </p>
<div class="fragment"><pre class="fragment">    <a class="code" href="classwx_notebook.html" title="This class represents a notebook control, which manages multiple windows with associated tabs...">wxNotebook</a> *book = <span class="keyword">new</span> <a class="code" href="classwx_notebook.html" title="This class represents a notebook control, which manages multiple windows with associated tabs...">wxNotebook</a>(parent, <a class="code" href="defs_8h.html#ac66d0a09761e7d86b2ac0b2e0c6a8cbba1f375b01ea03a713bbb7e32a36a2589c" title="Any id: means that we don&amp;#39;t care about the id, whether when installing an event handler or when c...">wxID_ANY</a>);
    book-&gt;<a class="code" href="classwx_window.html#af80875cda5e1af98dcd7c8e712e3c800" title="Sets the window&amp;#39;s name.">SetName</a>(<span class="stringliteral">&quot;MyBook&quot;</span>); <span class="comment">// do not use the default name</span>
    book-&gt;<a class="code" href="classwx_book_ctrl_base.html#ab47f8935c3705a452fce7d292d8181dd" title="Adds a new page.">AddPage</a>(...);
    book-&gt;<a class="code" href="classwx_book_ctrl_base.html#ab47f8935c3705a452fce7d292d8181dd" title="Adds a new page.">AddPage</a>(...);
    book-&gt;<a class="code" href="classwx_book_ctrl_base.html#ab47f8935c3705a452fce7d292d8181dd" title="Adds a new page.">AddPage</a>(...);
    <span class="keywordflow">if</span> ( !<a class="code" href="classwx_persistence_manager.html#aa6a195c6e56cb6e325d2f07afb0e0a44" title="Combines both Register() and Restore() calls.">wxPersistenceManager::RegisterAndRestore</a>(book) )
    {
        <span class="comment">// nothing was restored, so choose the default page ourselves</span>
        book-&gt;<a class="code" href="classwx_notebook.html#a140d1743bc93c3aff36fe2c9f1cb2bc8" title="Sets the selection for the given page, returning the previous selection.">SetSelection</a>(0);
    }
</pre></div><h2><a class="anchor" id="persistence_defining"></a>
Defining Custom Persistent Windows</h2>
<p>User-defined classes can be easily integrated with <a class="el" href="classwx_persistence_manager.html" title="Provides support for automatically saving and restoring object properties to persistent storage...">wxPersistenceManager</a>. To add support for your custom class <code>MyWidget</code> you just need to:</p>
<ol type="1">
<li>Define a new <code>MyPersistentWidget</code> class inheriting from wxPersistentWindow&lt;MyWidget&gt;.</li>
<li>Implement its pure virtual GetKind() method returning a unique string identifying all <code>MyWidget</code> objects, typically something like <code>"widget"</code> </li>
<li>Implement its pure virtual Save() and Restore() methods to actually save and restore the widget settings using <a class="el" href="classwx_persistent_object.html#aa29d1261d86f638dcbc3813e10f05b30" title="Save the specified value using the given name.">wxPersistentObject::SaveValue()</a> and <a class="el" href="classwx_persistent_object.html#a0f55e4f45d2569287cbd527c54445ebf" title="Restore the value saved by Save().">wxPersistentObject::RestoreValue()</a> methods.</li>
<li>Define <a class="el" href="interface_2wx_2persist_2bookctrl_8h.html#a8b21681a5cb6009c8acb05f474ca1899" title="Overload allowing persistence adapter creation for wxBookCtrlBase-derived objects.">wxCreatePersistentObject()</a> overload taking <code>MyWidget</code> * and returning a new <code>MyPersistentWidget</code> object.</li>
</ol>
<p>If you want to add persistence support for a class not deriving from <a class="el" href="classwx_window.html" title="wxWindow is the base class for all windows and represents any visible object on screen.">wxWindow</a>, you need to derive <code>MyPersistentWidget</code> directly from <a class="el" href="classwx_persistent_object.html" title="Base class for persistent object adapters.">wxPersistentObject</a> and so implement its pure virtual <a class="el" href="classwx_persistent_object.html#ae175687a86da6a3d0d6edac12840d7e0" title="Returns the string uniquely identifying the object we&#39;re associated with among all the other obje...">wxPersistentObject::GetName()</a> method too. Additionally, you must ensure that <a class="el" href="classwx_persistence_manager.html#ab8a9b090b5f84df7b6a765fed78d4820" title="Combines both Save() and Unregister() calls.">wxPersistenceManager::SaveAndUnregister()</a> is called when your object is destroyed as this can be only done automatically for windows. </p>
</div>
<!--BEGIN GENERATE_TREEVIEW-->
    <li class="footer">
    	Page generated on Tue Dec 27 2011 19:36:05 by <!--[Doxygen 1.7.6+] $generatedby -->
    	<a href="http://www.doxygen.org/index.html" target="_new">Doxygen</a> 1.7.1</li>
   </ul>
 </div>
<!--END GENERATE_TREEVIEW-->
<!--BEGIN !GENERATE_TREEVIEW-->
<hr class="footer"/>
<address class="footer">
	<small>
		Page generated on Tue Dec 27 2011 19:36:05 by <!--[Doxygen 1.7.6+] $generatedby -->
		<a href="http://www.doxygen.org/index.html" target="_new">Doxygen</a> 1.7.1
	</small>
</address>
<!--END !GENERATE_TREEVIEW-->

<script src="wxwidgets.js" type="text/javascript"></script>

</body>
</html>
